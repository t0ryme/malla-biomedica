<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Ing. Civil BiomÃ©dica â€“ Interactiva</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #1e1b2e;
      color: #fff;
      text-align: center;
      padding: 20px;
    }

    h1 {
      color: #c7a4ff;
      margin-bottom: 20px;
    }

    #progreso {
      font-size: 18px;
      margin: 15px 0;
      font-weight: bold;
      color: #f0f0f0;
    }

    #reset {
      background: #d9534f;
      color: white;
      border: none;
      padding: 10px 15px;
      margin: 15px 0;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
    }
    #reset:hover {
      background: #c9302c;
    }

    .semestre {
      margin: 20px auto;
      padding: 15px;
      background: #2b2640;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.4);
      max-width: 800px;
    }

    .semestre h2 {
      color: #b794f4;
      margin-bottom: 10px;
    }

    .ramo {
      display: inline-block;
      margin: 5px;
      padding: 10px 14px;
      border: none;
      border-radius: 10px;
      background: #4a3f6d;
      color: white;
      cursor: pointer;
      transition: all 0.2s;
    }

    .ramo:hover {
      background: #6c5aa8;
    }

    .ramo.locked {
      background: #555;
      cursor: not-allowed;
      opacity: 0.6;
    }

    .ramo.approved {
      background: #28a745 !important;
      color: white;
    }

    .pulse {
      animation: pulseAnim 0.4s;
    }

    @keyframes pulseAnim {
      0% { transform: scale(1); }
      50% { transform: scale(1.15); }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body>
  <h1>Malla Interactiva â€“ IngenierÃ­a Civil BiomÃ©dica</h1>

  <div id="progreso">Progreso: 0/0 (0%)</div>
  <div id="malla"></div>
  <button id="reset">ðŸ”„ Reiniciar malla</button>

  <script>
    const ramos = [
      /* PRIMER AÃ‘O */
      { id: "D.P", nombre: "Desarrollo personal", semestre: "1Âº", requisitos: []},
      { id: "F.M", nombre: "Fundamentos de matemÃ¡tica", semestre: "1Âº", requisitos: []},
      { id: "Q.I", nombre: "QuÃ­mica para ingenierÃ­a", semestre: "1Âº", requisitos: []},
      { id: "F.P", nombre: "Fundamentos de programaciÃ³n", semestre: "1Âº", requisitos: []},
      { id: "D.I", nombre: "DesafÃ­os de ingenierÃ­a", semestre: "1Âº", requisitos: []},

      { id: "F.F", nombre: "Fundamentos de fÃ­sica", semestre: "2Âº", requisitos: []},
      { id: "C.D", nombre: "CÃ¡lculo diferencial", semestre: "2Âº", requisitos: ["F.M"]},
      { id: "A", nombre: "Ãlgebra", semestre: "2Âº", requisitos: ["F.M"]},
      { id: "I.I.E", nombre: "IngenierÃ­a, innovaciÃ³n y emprendimiento", semestre: "2Âº", requisitos: ["D.I"]},
      { id: "P", nombre: "ProgramaciÃ³n", semestre: "2Âº", requisitos: ["F.P"]},

      /* SEGUNDO AÃ‘O */
      { id: "C.I.S", nombre: "CÃ¡lculo integral y series", semestre: "3Âº", requisitos: ["C.D"]},
      { id: "A.L", nombre: "Ãlgebra lineal", semestre: "3Âº", requisitos: ["A"]},
      { id: "F.MEC", nombre: "FÃ­sica mecÃ¡nica", semestre: "3Âº", requisitos: ["F.F","C.D"]},
      { id: "G.D", nombre: "GestiÃ³n de datos de salud", semestre: "3Âº", requisitos: ["F.P"]},
      { id: "B.C", nombre: "BiologÃ­a celular", semestre: "3Âº", requisitos: []},
      { id: "T.I", nombre: "Taller de integraciÃ³n perfil sello uv 1", semestre: "3Âº", requisitos: ["F.P"]},

      { id: "CVV", nombre: "CÃ¡lculo en varias variables", semestre: "4Âº", requisitos: ["C.I.S","A.L"]},
      { id: "EDO", nombre: "Ecuaciones diferenciales ordinarias", semestre: "4Âº", requisitos: ["C.I.S","A.L"]},
      { id: "FE", nombre: "FÃ­sica electromagnetismo", semestre: "4Âº", requisitos: ["C.I.S","F.MEC"]},
      { id: "EC", nombre: "EstadÃ­stica computacional", semestre: "4Âº", requisitos: ["F.P","C.D"]},
      { id: "FS1", nombre: "FisiologÃ­a de sistemas I", semestre: "4Âº", requisitos: ["B.C"]},
      { id: "I", nombre: "InglÃ©s", semestre: "4Âº", requisitos: ["D.P"]},

      /* TERCER AÃ‘O */
      { id: "EA", nombre: "ElectrÃ³nica analÃ³gica", semestre: "5Âº", requisitos: ["EDO","FE"]},
      { id: "LABEA", nombre: "Laboratorio de electrÃ³nica analÃ³gica", semestre: "5Âº", requisitos: ["EDO","FE"]},
      { id: "FCO", nombre: "FÃ­sica, calor y ondas", semestre: "5Âº", requisitos: ["C.I.S","F.MEC"]},
      { id: "MNO", nombre: "MÃ©todos numÃ©ricos y optimizaciÃ³n", semestre: "5Âº", requisitos: ["A.L","G.D"]},
      { id: "FS2", nombre: "FisiologÃ­a de sistemas II", semestre: "5Âº", requisitos: ["B.C"]},
      { id: "TI2", nombre: "Taller de integraciÃ³n perfil sello uv 2", semestre: "5Âº", requisitos: ["G.D"]},

      { id: "ED", nombre: "ElectrÃ³nica digital", semestre: "6Âº", requisitos: ["F.P","EA"]},
      { id: "LABED", nombre: "Laboratorio de electrÃ³nica digital", semestre: "6Âº", requisitos: ["F.P","LABEA"]},
      { id: "BM", nombre: "Mediciones biomÃ©dicas", semestre: "6Âº", requisitos: ["B.C","EA"]},
      { id: "GI", nombre: "GrÃ¡fica en ingenierÃ­a", semestre: "6Âº", requisitos: ["F.M"]},
      { id: "GOS", nombre: "GestiÃ³n de organizaciones de salud", semestre: "6Âº", requisitos: ["G.D"]},
      { id: "SPSS", nombre: "Salud pÃºblica y sistemas de salud", semestre: "6Âº", requisitos: ["TI2","G.D"]},

      /* CUARTO AÃ‘O */
      { id: "EM1", nombre: "Equipos mÃ©dicos 1", semestre: "7Âº", requisitos: ["EA","LABEA","FS2"]},
      { id: "ICA", nombre: "IngenierÃ­a de control automÃ¡tico", semestre: "7Âº", requisitos: ["EDO"]},
      { id: "SYM", nombre: "SeÃ±ales y sistemas", semestre: "7Âº", requisitos: ["EDO","EC","FS1"]},
      { id: "RDYC", nombre: "Redes de datos y comunicaciones", semestre: "7Âº", requisitos: ["G.D"]},
      { id: "ISH", nombre: "IngenierÃ­a de seguridad hospitalaria", semestre: "7Âº", requisitos: ["EA"]},
      { id: "GOPH", nombre: "GestiÃ³n de operaciones y procesos hospitalarios", semestre: "7Âº", requisitos: ["GOS"]},
      { id: "P1", nombre: "PrÃ¡ctica I", semestre: "7Âº", requisitos: ["EA","MNO","FS2"]},

      { id: "EM2", nombre: "Equipos mÃ©dicos 2", semestre: "8Âº", requisitos: ["EA","LABEA","FS2"]},
      { id: "LABSE", nombre: "Laboratorio de sistemas embebidos", semestre: "8Âº", requisitos: ["LABEA","LABED","FCO"]},
      { id: "PDIM", nombre: "Procesamiento digital de imÃ¡genes mÃ©dicas", semestre: "8Âº", requisitos: ["SYM"]},
      { id: "SIPS", nombre: "Sistemas de informaciÃ³n para salud", semestre: "8Âº", requisitos: ["RDYC","GOPH"]},
      { id: "ICYET", nombre: "IngenierÃ­a clÃ­nica y evaluaciÃ³n de tecnologÃ­as", semestre: "8Âº", requisitos: ["GOS"]},
      { id: "TDI", nombre: "Taller de integraciÃ³n", semestre: "8Âº", requisitos: ["BM"]},

      /* QUINTO AÃ‘O */
      { id: "EM3", nombre: "Equipos mÃ©dicos 3", semestre: "9Âº", requisitos: ["BM","FS2"]},
      { id: "E1", nombre: "Electivo 1", semestre: "9Âº", requisitos: ["BM"]},
      { id: "IAS", nombre: "Inteligencia artificial para la salud", semestre: "9Âº", requisitos: ["MNO"]},
      { id: "GCT", nombre: "GestiÃ³n de calidad y tecnovigilancia", semestre: "9Âº", requisitos: ["SPSS","EC"]},
      { id: "ICALM", nombre: "IngenierÃ­a clÃ­nica aplicada y laboratorio de mantenimiento", semestre: "9Âº", requisitos: ["ISH","ICYET"]},
      { id: "FYEDP", nombre: "FormulaciÃ³n y evaluaciÃ³n de proyectos", semestre: "9Âº", requisitos: ["GOS"]},

      { id: "EM4", nombre: "Equipos mÃ©dicos 4", semestre: "10Âº", requisitos: ["PDIM","SIPS"]},
      { id: "DDSBM", nombre: "DiseÃ±o y desarrollo de soluciones biomÃ©dicas", semestre: "10Âº", requisitos: ["ICA","LABSE"]},
      { id: "ESYTM", nombre: "E-salud y telemedicina", semestre: "10Âº", requisitos: ["SIPS"]},
      { id: "E2", nombre: "Electivo 2", semestre: "10Âº", requisitos: ["GOPH"]},
      { id: "E3", nombre: "Electivo 3", semestre: "10Âº", requisitos: ["BM"]},
      { id: "EPH", nombre: "Estudio de preinversiÃ³n hospitalaria", semestre: "10Âº", requisitos: ["EM1","ICYET","FYEDP"]},

      /* SEXTO AÃ‘O */
      { id: "PDT", nombre: "Proyecto de tÃ­tulo", semestre: "11Âº", requisitos: ["SIPS","TDI","ICALM","EPH","DDSBM"]},
      { id: "P2", nombre: "PrÃ¡ctica II", semestre: "11Âº", requisitos: ["GOPH","P1","EM2","SIPS","ICALM"]}
    ];

    /* ------------------ LÃ“GICA ------------------- */

    const mallaContainer = document.getElementById("malla");
    const progresoContainer = document.getElementById("progreso");
    const resetBtn = document.getElementById("reset");

    let aprobados = new Set(JSON.parse(localStorage.getItem("aprobados")) || []);

    function guardarProgreso() {
      localStorage.setItem("aprobados", JSON.stringify([...aprobados]));
    }

    function puedeAprobar(ramo) {
      return ramo.requisitos.every(r => aprobados.has(r));
    }

    function crearBotonRamo(ramo) {
      const btn = document.createElement("button");
      btn.textContent = `${ramo.nombre} (${ramo.semestre})`;
      btn.className = "ramo";

      if (aprobados.has(ramo.id)) {
        btn.classList.add("approved");
      } else if (!puedeAprobar(ramo)) {
        btn.classList.add("locked");
        btn.disabled = true;
      }

      btn.addEventListener("click", () => {
        if (btn.classList.contains("approved")) {
          aprobados.delete(ramo.id);
          btn.classList.remove("approved");
        } else {
          if (puedeAprobar(ramo)) {
            aprobados.add(ramo.id);
            btn.classList.add("approved");
            btn.classList.add("pulse");
            setTimeout(() => btn.classList.remove("pulse"), 500);
          }
        }
        guardarProgreso();
        actualizarEstado();
      });

      return btn;
    }

    function actualizarEstado() {
      const botones = mallaContainer.querySelectorAll("button.ramo");
      botones.forEach(btn => {
        const ramo = ramos.find(r => btn.textContent.startsWith(r.nombre));
        if (ramo) {
          if (puedeAprobar(ramo) || aprobados.has(ramo.id)) {
            btn.disabled = false;
            btn.classList.remove("locked");
          } else {
            if (!aprobados.has(ramo.id)) {
              btn.disabled = true;
              btn.classList.add("locked");
              btn.classList.remove("approved");
            }
          }
        }
      });
      actualizarProgreso();
    }

    function actualizarProgreso() {
      const total = ramos.length;
      const completados = aprobados.size;
      const porcentaje = Math.round((completados / total) * 100);
      progresoContainer.textContent = `Progreso: ${completados}/${total} ramos (${porcentaje}%)`;
    }

    function cargarMalla() {
      const semestres = {};
      ramos.forEach(r => {
        if (!semestres[r.semestre]) semestres[r.semestre] = [];
        semestres[r.semestre].push(r);
      });

      for (const semestre in semestres) {
        const divSem = document.createElement("div");
        divSem.className = "semestre";
        const h2 = document.createElement("h2");
        h2.textContent = `Semestre ${semestre}`;
        divSem.appendChild(h2);

        semestres[semestre].forEach(ramo => {
          const boton = crearBotonRamo(ramo);
          divSem.appendChild(boton);
        });

        mallaContainer.appendChild(divSem);
      }
      actualizarEstado();
    }

    resetBtn.addEventListener("click", () => {
      if (confirm("Â¿Seguro que quieres reiniciar la malla?")) {
        aprobados.clear();
        guardarProgreso();
        mallaContainer.innerHTML = "";
        cargarMalla();
      }
    });

    // Inicializar
    cargarMalla();
  </script>
</body>
</html>
